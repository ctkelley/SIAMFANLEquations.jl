<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>aasol: solve fixed point prolbems with Anderson acceleration · SIAMFANLEquations.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="SIAMFANLEquations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SIAMFANLEquations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../nsol/">nsol: systems of equations with direct linear solvers</a></li><li><a class="tocitem" href="../ptcsol/">ptcsol: Pseudo-Transient Continuation Solver</a></li><li><a class="tocitem" href="../nsoli/">nsoli: systems of equations with Krylov linear solvers</a></li><li><a class="tocitem" href="../ptcsoli/">ptcsoli: Pseudo-Transient Continuation Newton-Krylov Solver</a></li><li class="is-active"><a class="tocitem" href>aasol: solve fixed point prolbems with Anderson acceleration</a></li></ul></li><li><span class="tocitem">Scalar Equations</span><ul><li><a class="tocitem" href="../nsolsc/">nsolsc: scalar equation solver</a></li><li><a class="tocitem" href="../ptcsolsc/">ptcsolsc: pseudo-transient continuation</a></li><li><a class="tocitem" href="../secant/">secant: scalar equation solver</a></li></ul></li><li><span class="tocitem">Linear Solvers</span><ul><li><a class="tocitem" href="../kl_gmres/">kl_gmres: GMRES linear solver</a></li><li><a class="tocitem" href="../kl_bicgstab/">kl_bigstab: BiCGSTAB linear solver</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Solvers</a></li><li class="is-active"><a href>aasol: solve fixed point prolbems with Anderson acceleration</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>aasol: solve fixed point prolbems with Anderson acceleration</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ctkelley/SIAMFANLEquations.jl/blob/master/docs/src/functions/aasol.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="aasol:-solve-fixed-point-prolbems-with-Anderson-acceleration"><a class="docs-heading-anchor" href="#aasol:-solve-fixed-point-prolbems-with-Anderson-acceleration">aasol: solve fixed point prolbems with Anderson acceleration</a><a id="aasol:-solve-fixed-point-prolbems-with-Anderson-acceleration-1"></a><a class="docs-heading-anchor-permalink" href="#aasol:-solve-fixed-point-prolbems-with-Anderson-acceleration" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="SIAMFANLEquations.aasol-NTuple{4, Any}" href="#SIAMFANLEquations.aasol-NTuple{4, Any}"><code>SIAMFANLEquations.aasol</code></a> — <span class="docstring-category">Method</span></header><section><div><p>aasol(GFix!, x0, m, Vstore; maxit=20,       rtol=1.e-10, atol=1.e-10, beta=1.0, pdata=nothing, keepsolhist = false)</p><p>C. T. Kelley, 2021</p><p>Julia code for Anderson acceleration. Nothing fancy.</p><p>Solvers fixed point problems x = G(x).</p><p>WARNING! This is an alpha version of the solver. The API may change and the management of the optimization problem WILL change.</p><p>You must allocate storage for the function and fixed point map history –&gt; in the calling program &lt;– in the array Vstore.</p><p>For an n dimensional problem with Anderson(m), Vstore must have at least 2m+2 columns. THIS MAY CHANGE!!!</p><p>Inputs:</p><ul><li><p>GFix!: fixed-point map, the ! indicates that GFix! overwrites xout, your   preallocated storage for the function value xout=G(xin).</p><p>So xout=GFix!(xout,xin) or xout=GFix!(xout,xin,pdata) returns   xout=G(xin)</p></li><li><p>sol: Initial iterate</p></li><li><p>m: depth for Anderson acceleration. m=0 is Picard iteration</p></li><li><p>Vstore: Working storage array. For an n dimensional problem Vstore should have at least 2m+2 columns. So for Anderson(3), Vstore should be no smaller than zeros(n,8)</p></li></ul><p>Keyword Arguments (kwargs):</p><p>maxit: default = 20</p><p>limit on nonlinear iterations</p><p>rtol and atol: default = 1.e-10</p><p>relative and absolute error tolerances</p><p>beta:</p><p>Anderson mixing parameter. Changes G(x) to (1-beta)x + beta G(x). Equivalent to accelerating damped Picard iteration.</p><p>pdata:</p><p>precomputed data for the fixed point map. Things will go better if you use this rather than hide the data in global variables within the module for your function.</p><p>keepsolhist: default = false</p><p>Set this to true to get the history of the iteration in the output tuple. This is on by default for scalar equations and off for systems. Only turn it on if you have use for the data, which can get REALLY LARGE.</p><p>Output:</p><ul><li>A named tuple (solution, functionval, history, stats, idid,              errcode, solhist)</li></ul><p>where</p><p>– solution = converged result</p><p>– functionval = G(solution)       You might want to use functionval as your solution since it&#39;s       a Picard iteration applied to the converged Anderson result. If G       is a contraction it will be better than the solution.</p><p>– history = the vector of residual norms (||x-G(x)||) for the iteration</p><p>– stats = named tuple (condhist, alphanorm) of the history of the               condition numbers of the optimization problem               and l1 norm of the coefficients.  This is only for diagosing problems and research. Condihist[k] and alphanorm[k] are the condition number and coefficient norm for the optimization problem that computes iteration k+1 from iteration k. </p><p>I record this for iterations k=1, ... until the final iteration  K. So I do not record the stats for k=0 or the final iteration.  We did record the data for the final iteration in Toth/Kelley  2015 at the cost of an extra optimiztion problem solve.  Since we&#39;ve already terminated, there&#39;s not any point in  collecting that data.</p><p>Bottom line: if history has length K+1 for iterations  0 ... K, then condhist and alphanorm have length K-1.</p><p>– idid=true if the iteration succeeded and false if not.</p><p>– errcode = 0 if if the iteration succeeded</p><pre><code class="nohighlight hljs">    = -1 if the initial iterate satisfies the termination criteria

    = 10 if no convergence after maxit iterations</code></pre><p>– solhist:</p><p>This is the entire history of the iteration if you&#39;ve set keepsolhist=true</p><p>solhist is an N x K array where N is the length of x and K is the number of iterations + 1. </p><p><strong>Examples from the docstrings for aasol</strong></p><p><strong>Duplicate Table 1 from Toth-Kelley 2015.</strong></p><p>The final entries in the condition number and coefficient norm statistics are never used in the computation and we don&#39;t compute them in Julia. See the docstrings, notebook, and the print book for the story on this.</p><pre><code class="language-julia-repl hljs">julia&gt; function tothk!(G, u)
       G[1]=cos(.5*(u[1]+u[2]))
       G[2]=G[1]+ 1.e-8 * sin(u[1]*u[1])
       return G
       end
tothk! (generic function with 1 method)

julia&gt; u0=ones(2,); m=2; vdim=2*(m+1); Vstore = zeros(2, vdim);
julia&gt; aout = aasol(tothk!, u0, m, Vstore; rtol = 1.e-10);
julia&gt; aout.history
8-element Vector{Float64}:
 6.50111e-01
 4.48661e-01
 2.61480e-02
 7.25389e-02
 1.53107e-04
 1.18512e-05
 1.82476e-08
 1.04804e-13

julia&gt; [aout.stats.condhist aout.stats.alphanorm]
6×2 Matrix{Float64}:
 1.00000e+00  1.00000e+00
 2.01556e+10  4.61720e+00
 1.37776e+09  2.15749e+00
 3.61344e+10  1.18377e+00
 2.54947e+11  1.00000e+00
 3.67672e+10  1.00171e+00</code></pre><p><strong>H-equation example with m=2. This takes more iterations than</strong></p><p>Newton, which should surprise no one.</p><pre><code class="language-julia-repl hljs">julia&gt; n=16; x0=ones(n,); Vstore=zeros(n,20); m=2;
julia&gt; hdata=heqinit(x0,.99);
julia&gt; hout=aasol(HeqFix!, x0, m, Vstore; pdata=hdata);
julia&gt; hout.history
12-element Vector{Float64}:
 1.47613e+00
 7.47800e-01
 2.16609e-01
 4.32017e-02
 2.66867e-02
 6.82965e-03
 2.70779e-04
 6.51027e-05
 7.35581e-07
 1.85649e-09
 4.94803e-10
 5.18866e-12
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ctkelley/SIAMFANLEquations.jl/blob/fae80cb8367315c9c8cfb7fa7bdd640ec28d2317/src/Solvers/aasol.jl#L1-L180">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ptcsoli/">« ptcsoli: Pseudo-Transient Continuation Newton-Krylov Solver</a><a class="docs-footer-nextpage" href="../nsolsc/">nsolsc: scalar equation solver »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.6 on <span class="colophon-date" title="Saturday 18 September 2021 18:47">Saturday 18 September 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
